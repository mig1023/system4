@page "/apps/{appid}"
@model system4.Pages.Docs.AppModel
@{
    ViewData["Title"] = "App";
}

<div class="container p-0">
    <h1 class="display-5 padding_headers">Информация о записи на подачу:</h1>
    <div class="row align-items-start">
        <div class="col">
            <div class="container p-0">
                <div class="row align-items-start">
                    <div class="col-4">Номер записи:</div>
                    <div class="col-sm-8">@Model.Appointment.AppNum</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Дата записи:</div>
                    <div class="col-sm-8">@Model.Appointment.AppDate.ToString("dd.MM.yyyy")</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Время записи:</div>
                    <div class="col-sm-8">@Model.Appointment.TimeslotID</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Визоый центр:</div>
                    <div class="col-sm-8">@Model.Appointment.Center.BName</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Тип визы:</div>
                    <div class="col-sm-8"><b>@Model.Appointment.VisaType.VName</b></div>
                </div>  
                <div class="row align-items-start">
                    <div class="col-4">Статус:</div>
                    <div class="col-sm-8"><b>@DAL.Constants.AppStatuses(Model.Appointment.Status)</b></div>
                </div> 
                <div class="row align-items-start">
                    <div class="col-4">Доставка:</div>
                    <div class="col-sm-8">@(Model.Appointment.Shipping > 0 ? Model.Appointment.ShAddress : "нет")</div>
                </div> 
                <div class="row align-items-start">
                    <div class="col-4">Отправка SMS:</div>
                    <div class="col-sm-8">@(Model.Appointment.SMS > 0 ? Model.Appointment.Mobile : "нет")</div>
                </div> 
                <div class="row align-items-start">
                    <div class="col-4">Документы подаются:</div>
                    @if (Model.Appointment.Dwhom > 0)
                    {
                        <div class="col-sm-8 poa_style">
                            по доверенности<br />
                            @Model.Appointment.LName @Model.Appointment.LName @Model.Appointment.LName<br/>
                            @Model.Appointment.PassNum<br />
                            @Model.Appointment.PassWhom
                        </div>
                    }
                    else
                    {
                        <div class="col-sm-8">лично</div>
                    }
                </div> 
            </div>
        </div>
        <div class="col">
            <div class="container">
                <div class="row align-items-start">
                    <div class="col-4">EMail:</div>
                    <div class="col-sm-8">@Model.Appointment.EMail</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Телефон:</div>
                    <div class="col-sm-8">@Model.Appointment.Phone</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Мобильный:</div>
                    <div class="col-sm-8">@Model.Appointment.Mobile</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Адрес:</div>
                    <div class="col-sm-8">@Model.Appointment.Address</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container p-0">
    <h1 class="display-5 padding_headers">Список заявителей:</h1>
    <table class="table">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">ФИО</th>
                <th scope="col">Загранпаспорт</th>
                <th scope="col">Н/рез</th>
                <th scope="col">День рождения</th>
                <th scope="col">Статус</th>
            </tr>
        </thead>
        <tbody>
            @{
                int i = 1;
                foreach (DAL.AppData app in Model.Appointment.AppData)
                {
                    <tr>
                        <th scope="row">@(i++)</th>
                        <td>@app.FName @app.LName</td>
                        <td>@app.PassNum</td>
                        <td>@(app.NRes > 0 ? "да" : "")</td>
                        <td>@app.BirthDate.ToString("dd.MM.yyyy")</td>
                        <td>@DAL.Constants.AppStatuses(app.Status)</td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>

@if (Model.Appointment.Comments.Count > 0)
{
    <p> </p>

    <div class="border border-danger">
        @foreach (DB.AppComments comment in Model.Appointment.Comments)
        {
            <div class="row align-items-start m-3 comment_text">
                <span>@comment.CommentText
                    <span class="comment_text_data">@comment.Login</span>
                    <span class="comment_text_data">@comment.CommentDate.ToString("dd.MM.yyyy HH:mm")</span>
                </span>
            </div>
        }

    </div>
}

<div class="container p-0 comment_text padding_headers">
    <table>
        <tr>
            <td>Дата последнего изменения:</td>
            <td>@Model.Appointment.RDate.ToString("dd.MM.yyyy HH:mm:SS")</td>
        </tr>
        <tr>
            <td>Создал:</td>
            <td>@Model.Appointment.Login</td>
        </tr>
        <tr>
            <td>Примечания:</td>
            <td>@Model.Appointment.Notes</td>
        </tr>
    </table>
</div>