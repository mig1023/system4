@page "/doc/{docid}"
@model system4.Pages.Docs.DocModel
@{
    ViewData["Title"] = "Doc";
}

<div class="container p-0">
    <h1 class="display-5 padding_headers">Информация о договоре:</h1>
    <div class="row align-items-start">
        <div class="col">
            <div class="container p-0">
                <div class="row align-items-start">
                    <div class="col-4">Номер договора:</div>
                    <div class="col-sm-8">@Model.DocPack.AgreementNo</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Дата договора:</div>
                    <div class="col-sm-8">@Model.DocPack.PDate.ToString("dd.MM.yyyy")</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Визоый центр:</div>
                    <div class="col-sm-8">@Model.DocPack.Center.BName</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Тип визы:</div>
                    <div class="col-sm-8"><b>@Model.DocPack.VisaTypeLine.VName</b></div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Статус:</div>
                    <div class="col-sm-8"><b>@Model.DocPack.StatusLine</b></div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Доставка:</div>
                    @if (Model.DocPack.Shipping > 0)
                    {
                        <div class="col-sm-8 poa_style">
                            @Model.DocPack.AddrIndex<br/>
                            @Model.DocPack.ShippingAddress<br />
                            @Model.DocPack.ShippingPhone
                        </div>
                    }
                    else
                    {
                        <div class="col-sm-8">нет</div>
                    }
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Отправка SMS:</div>
                    <div class="col-sm-8"><b>@(Model.DocPack.SMS > 0 ? Model.DocPack.Mobile : "нет")</b></div>

                </div>
                <div class="row align-items-start">
                    <div class="col-4">Сумма по договору:</div>
                    <div class="col-sm-8">@Model.DocPack.DSum @Model.DocPack.Cur</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Сумма КС:</div>
                    <div class="col-sm-8">ХХХХ @Model.DocPack.Cur</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Тип оплаты:</div>
                    <div class="col-sm-8">@Model.DocPack.PType</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Запись на подачу:</div>
                    <div class="col-sm-8"><a class="normal-link" href="/app/@Model.DocPack.Appointment.Id/">
                        @Model.DocPack.Appointment.AppNum</a></div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Ксерокопия:</div>
                    <div class="col-sm-8">@Model.DocPack.XeroxPage страниц</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Страховка:</div>
                    <div class="col-sm-8">@Model.DocPack.InsSum @Model.DocPack.Cur</div>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="container">
                <div class="row align-items-start">
                    <div class="col-4">Оформлен:</div>
                    @if (Model.DocPack.DovDate.Date != DateTime.MinValue)
                    {
                        <div class="col-sm-8"><b>по доверенности (№ 
                            @Model.DocPack.DovNum от @Model.DocPack.DovDate.ToString("dd.MM.yyyy"))</b></div>
                    }
                    else
                    {
                        <div class="col-sm-8">лично</div>
                    }
                </div>
                <div class="row align-items-start">
                    <div class="col-4">На кого:</div>
                    <div class="col-sm-8">@Model.DocPack.LName @Model.DocPack.FName @Model.DocPack.MName</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Паспорт:</div>
                    <div class="col-sm-8">@Model.DocPack.PassNum, @Model.DocPack.PassDate, @Model.DocPack.PassWhom</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Телефон:</div>
                    <div class="col-sm-8">@Model.DocPack.Phone</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Адрес:</div>
                    <div class="col-sm-8">@Model.DocPack.Address</div>
                </div>
                <div class="row align-items-start">
                    <div class="col-4">Информация:</div>
                    <div class="col-sm-8">@Model.DocPack.DocPackOptional.SendInfoEmail</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container p-0">
    <h1 class="display-5 padding_headers">Список заявителей:</h1>
    <table class="table">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">ФИО</th>
                <th scope="col">Загранпаспорт</th>
                <th scope="col">День рождения</th>
                <th scope="col">День вылета</th>
                <th scope="col">Н/рез</th>
                <th scope="col">Без КС</th>
                <th scope="col">Отказ</th>
                <th scope="col">BankId</th>
                <th scope="col">Статус</th>
            </tr>
        </thead>
        <tbody>
            @{
                int i = 1;
                foreach (DAL.DocPackInfo docinfo in Model.DocPack.DocPackInfo)
                {
                    foreach (DAL.DocPackList doclist in docinfo.DocPackList)
                    {
                        <tr>
                            <th scope="row">@(i++)</th>
                            <td>@doclist.FName @doclist.LName (@doclist.AppData.FName @doclist.AppData.LName)</td>
                            <td>@doclist.PassNum</td>
                            <td>@doclist.BthDate.ToString("dd.MM.yyyy")</td>
                            <td>@doclist.FlyDate.ToString("dd.MM.yyyy")</td>
                            <td>@(doclist.iNRes > 0 ? "да" : "")</td>
                            <td>@(doclist.Concil > 0 ? "да" : "")</td>
                            <td>@(doclist.Reject > 0 ? "да" : "")</td>
                            <td>@doclist.CBankId</td>
                            <td>@DAL.Constants.DocStatuses(doclist.Status)</td>
                        </tr>
                    }
                }
            }
        </tbody>
    </table>
</div>

@if (Model.DocPack.Comments.Count > 0)
{
    <div class="border border-danger padding_comments">
        @foreach (DB.DocComments comment in Model.DocPack.Comments)
        {
            <div class="row align-items-start m-3 comment_text">
                <span>
                    @comment.CommentText
                    <span class="comment_text_data">@comment.Login</span>
                    <span class="comment_text_data">@comment.CommentDate.ToString("dd.MM.yyyy HH:mm")</span>
                </span>
            </div>
        }

    </div>
}

<div class="container p-0 comment_text padding_headers">
    <table>
        <tr>
            <td>Дата создания:</td>
            <td>@Model.DocPack.ADate.ToString("dd.MM.yyyy HH:mm:SS")</td>
        </tr>
        <tr>
            <td>Создал:</td>
            <td>@Model.DocPack.Login</td>
        </tr>
    </table>
</div>